var tricubic = new function() {

	var Minv;
	var grid;
	var coeff = []
	this.iso = 0.0;	
	
	var fx = function(i, j, k)
	{
		return (grid[i+1][j][k] - grid[i-1][j][k]) * 0.5;
	}
	
	var fy = function(i, j, k)
	{
		return (grid[i][j+1][k] - grid[i][j-1][k]) * 0.5;
	}
	
	var fz = function(i, j, k)
	{
		return (grid[i][j][k+1] - grid[i][j][k-1]) * 0.5;
	}

	var fxy = function(i, j, k)
	{
		return (grid[i+1][j+1][k] - grid[i+1][j-1][k]-grid[i-1][j+1][k]+grid[i-1][j-1][k]) * 0.25;
	}

	var fxz = function(i, j, k)
	{
		return (grid[i+1][j][k+1] - grid[i+1][j][k-1]-grid[i-1][j][k+1]+grid[i-1][j][k-1]) * 0.25;
	}

	var fyz = function(i, j, k)
	{
		return (grid[i][j+1][k+1] - grid[i][j+1][k-1]-grid[i][j-1][k+1]+grid[i][j-1][k-1]) * 0.25;
	}
	
	var fxyz = function(i, j, k)
	{
		return (fxy(i, j, k+1) - fxy(i, j, k-1)) * 0.5;
	}
	
	this.f = function(x, y, z) {
		var ret = 0,
			pow_x = [1, x, x * x, x * x * x], 
			pow_y = [1, y, y * y, y * y * y], 
			pow_z = [1, z, z * z, z * z * z];
			
		for(var ii = 0; ii < 4; ++ii)
			for(var jj = 0; jj < 4; ++jj)
				for(var kk = 0; kk < 4; ++kk)
					ret += coeff[kk + jj * 4 + ii * 4 * 4] * pow_x[ii%4] * pow_y[jj%4] * pow_z[kk%4];
					
		return ret;
	};

	this.grad = function(x, y, z) {
	    var dx, dy, dz, 
	    pow_x = [0, 1, x, x * x, x * x * x], 
	    pow_y = [0, 1, y, y * y, y * y * y], 
	    pow_z = [0, 1, z, z * z, z * z * z], c;
	    
	    var ii, jj, kk;

	    dx = dy = dz = 0.0;
	    ii = 3;
	    do
	    {
		jj = 3;
		do
		{
		    kk = 3;
		    do
		    {
			c   = coeff[kk + jj * 4 + ii * 16];
			dx += c * ii * pow_x[(ii+0)%5] * pow_y[(jj+1)%5] * pow_z[(kk+1)%5];
			dy += c * jj * pow_x[(ii+1)%5] * pow_y[(jj+0)%5] * pow_z[(kk+1)%5];
			dz += c * kk * pow_x[(ii+1)%5] * pow_y[(jj+1)%5] * pow_z[(kk+0)%5];
		    }while(kk--);
		}while(jj--);
	    }while(ii--);
	    // dx = dy = dz = 0.0;
	    // for(var ii = 0; ii < 4; ++ii)
	    // {
	    // 	for(var jj = 0; jj < 4; ++jj)
	    // 	{
	    // 		for(var kk = 0; kk < 4; ++kk)
	    // 		{
	    // 			c   = coeff[kk + jj * 4 + ii * 4 * 4];
	    // 			dx += c * ii * pow_x[(ii+0)%5] * pow_y[(jj+1)%5] * pow_z[(kk+1)%5];
	    // 			dy += c * jj * pow_x[(ii+1)%5] * pow_y[(jj+0)%5] * pow_z[(kk+1)%5];
	    // 			dz += c * kk * pow_x[(ii+1)%5] * pow_y[(jj+1)%5] * pow_z[(kk+0)%5];
	    // 		}
	    // 	}
	    // }
	    return new THREE.Vector3(dx, dy, dz);
	};
	
	this.init = function(g) {
	
		grid = g;
	
		Minv = new Array(
	 [  1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [ -3,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  2,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [ -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -3,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [ -3,  -0,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -0,  -1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [ -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -3,  -0,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -0,  -1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  9,  -9,  -9,   9,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   6,  -6,   3,  -3,   0,   0,   0,   0,   6,   3,  -6,  -3,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   4,   2,   2,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [ -6,   6,   6,  -6,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -4,   4,  -2,   2,  -0,  -0,  -0,  -0,  -3,  -3,   3,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -2,  -1,  -1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  2,   0,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,   0,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [ -6,   6,   6,  -6,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -3,   3,  -3,   3,  -0,  -0,  -0,  -0,  -4,  -2,   4,   2,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -1,  -2,  -1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  4,  -4,  -4,   4,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,  -2,   2,  -2,   0,   0,   0,   0,   2,   2,  -2,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   1,   1,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [ -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -3,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   2,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0.],
	 [ -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -3,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -1,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   1,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,  -3,   0,   3,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -2,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -3,   0,   3,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -2,   0,  -1,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   9,  -9,  -9,   9,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   6,  -6,   3,  -3,   0,   0,   0,   0,   6,   3,  -6,  -3,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   4,   2,   2,   1,   0,   0,   0,   0.],
	 [ -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -6,   6,   6,  -6,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -4,   4,  -2,   2,  -0,  -0,  -0,  -0,  -3,  -3,   3,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -2,  -1,  -1,  -0,  -0,  -0,  -0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   2,   0,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,   0,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   1,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,  -6,   6,   6,  -6,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -3,   3,  -3,   3,   0,   0,   0,   0,  -4,  -2,   4,   2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -2,  -1,  -2,  -1,   0,   0,   0,   0.],
	 [ -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,   4,  -4,  -4,   4,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,   2,  -2,   2,  -2,  -0,  -0,  -0,  -0,   2,   2,  -2,  -2,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,   1,   1,   1,   1,  -0,  -0,  -0,  -0.],
	 [ -3,   0,   0,   0,   3,   0,   0,   0,  -2,   0,   0,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [ -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -3,  -0,  -0,  -0,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -0,  -0,  -0,  -1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  9,  -9,   0,   0,  -9,   9,   0,   0,   6,  -6,   0,   0,   3,  -3,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   6,   3,   0,   0,  -6,  -3,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   4,   2,   0,   0,   2,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [ -6,   6,  -0,  -0,   6,  -6,  -0,  -0,  -4,   4,  -0,  -0,  -2,   2,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -3,  -3,  -0,  -0,   3,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -2,  -0,  -0,  -1,  -1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -3,   0,   0,   0,   3,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -2,   0,   0,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -3,   0,   0,   0,   3,   0,   0,   0,  -2,   0,   0,   0,  -1,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   9,  -9,   0,   0,  -9,   9,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   6,  -6,   0,   0,   3,  -3,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   6,   3,   0,   0,  -6,  -3,   0,   0,   4,   2,   0,   0,   2,   1,   0,   0.],
	 [ -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -6,   6,  -0,  -0,   6,  -6,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -4,   4,  -0,  -0,  -2,   2,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -3,  -3,  -0,  -0,   3,   3,  -0,  -0,  -2,  -2,  -0,  -0,  -1,  -1,  -0,  -0.],
	 [  9,  -0,  -9,  -0,  -9,  -0,   9,  -0,   6,  -0,  -6,  -0,   3,  -0,  -3,  -0,   6,  -0,   3,  -0,  -6,  -0,  -3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,   4,  -0,   2,  -0,   2,  -0,   1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [ -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,   9,  -0,  -9,  -0,  -9,  -0,   9,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,   6,  -0,  -6,  -0,   3,  -0,  -3,  -0,   6,  -0,   3,  -0,  -6,  -0,  -3,  -0,   4,  -0,   2,  -0,   2,  -0,   1,  -0.],
	 [-27,  27,  27, -27,  27, -27, -27,  27, -18,  18,  18, -18,  -9,   9,   9,  -9, -18,  18,  -9,   9,  18, -18,   9,  -9, -18,  -9,  18,   9,  18,   9, -18,  -9, -12,  12,  -6,   6,  -6,   6,  -3,   3, -12,  -6,  12,   6,  -6,  -3,   6,   3, -12,  -6,  -6,  -3,  12,   6,   6,   3,  -8,  -4,  -4,  -2,  -4,  -2,  -2,  -1.],
	 [ 18, -18, -18,  18, -18,  18,  18, -18,  12, -12, -12,  12,   6,  -6,  -6,   6,  12, -12,   6,  -6, -12,  12,  -6,   6,   9,   9,  -9,  -9,  -9,  -9,   9,   9,   8,  -8,   4,  -4,   4,  -4,   2,  -2,   6,   6,  -6,  -6,   3,   3,  -3,  -3,   6,   6,   3,   3,  -6,  -6,  -3,  -3,   4,   4,   2,   2,   2,   2,   1,   1.],
	 [ -6,   0,   6,   0,   6,   0,  -6,   0,  -4,   0,   4,   0,  -2,   0,   2,   0,  -3,   0,  -3,   0,   3,   0,   3,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -2,   0,  -2,   0,  -1,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [ -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -6,  -0,   6,  -0,   6,  -0,  -6,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -4,  -0,   4,  -0,  -2,  -0,   2,  -0,  -3,  -0,  -3,  -0,   3,  -0,   3,  -0,  -2,  -0,  -2,  -0,  -1,  -0,  -1,  -0.],
	 [ 18, -18, -18,  18, -18,  18,  18, -18,  12, -12, -12,  12,   6,  -6,  -6,   6,   9,  -9,   9,  -9,  -9,   9,  -9,   9,  12,   6, -12,  -6, -12,  -6,  12,   6,   6,  -6,   6,  -6,   3,  -3,   3,  -3,   8,   4,  -8,  -4,   4,   2,  -4,  -2,   6,   3,   6,   3,  -6,  -3,  -6,  -3,   4,   2,   4,   2,   2,   1,   2,   1.],
	 [-12,  12,  12, -12,  12, -12, -12,  12,  -8,   8,   8,  -8,  -4,   4,   4,  -4,  -6,   6,  -6,   6,   6,  -6,   6,  -6,  -6,  -6,   6,   6,   6,   6,  -6,  -6,  -4,   4,  -4,   4,  -2,   2,  -2,   2,  -4,  -4,   4,   4,  -2,  -2,   2,   2,  -3,  -3,  -3,  -3,   3,   3,   3,   3,  -2,  -2,  -2,  -2,  -1,  -1,  -1,  -1.],
	 [  2,   0,   0,   0,  -2,   0,   0,   0,   1,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,   0,   0,   0,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [ -6,   6,  -0,  -0,   6,  -6,  -0,  -0,  -3,   3,  -0,  -0,  -3,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -4,  -2,  -0,  -0,   4,   2,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -2,  -1,  -0,  -0,  -2,  -1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  4,  -4,  -0,  -0,  -4,   4,  -0,  -0,   2,  -2,  -0,  -0,   2,  -2,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,   2,   2,  -0,  -0,  -2,  -2,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,   1,   1,  -0,  -0,   1,   1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,   0,   0,   0,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   1,   0,   0,   0,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,   0,   0,   0,  -2,   0,   0,   0,   1,   0,   0,   0,   1,   0,   0,   0.],
	 [ -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -6,   6,  -0,  -0,   6,  -6,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -3,   3,  -0,  -0,  -3,   3,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -4,  -2,  -0,  -0,   4,   2,  -0,  -0,  -2,  -1,  -0,  -0,  -2,  -1,  -0,  -0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   4,  -4,   0,   0,  -4,   4,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,  -2,   0,   0,   2,  -2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,   2,   0,   0,  -2,  -2,   0,   0,   1,   1,   0,   0,   1,   1,   0,   0.],
	 [ -6,   0,   6,   0,   6,   0,  -6,   0,  -3,   0,   3,   0,  -3,   0,   3,   0,  -4,   0,  -2,   0,   4,   0,   2,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -2,   0,  -1,   0,  -2,   0,  -1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -6,   0,   6,   0,   6,   0,  -6,   0,   0,   0,   0,   0,   0,   0,   0,   0,  -3,   0,   3,   0,  -3,   0,   3,   0,  -4,   0,  -2,   0,   4,   0,   2,   0,  -2,   0,  -1,   0,  -2,   0,  -1,   0.],
	 [ 18, -18, -18,  18, -18,  18,  18, -18,   9,  -9,  -9,   9,   9,  -9,  -9,   9,  12, -12,   6,  -6, -12,  12,  -6,   6,  12,   6, -12,  -6, -12,  -6,  12,   6,   6,  -6,   3,  -3,   6,  -6,   3,  -3,   6,   3,  -6,  -3,   6,   3,  -6,  -3,   8,   4,   4,   2,  -8,  -4,  -4,  -2,   4,   2,   2,   1,   4,   2,   2,   1.],
	 [-12,  12,  12, -12,  12, -12, -12,  12,  -6,   6,   6,  -6,  -6,   6,   6,  -6,  -8,   8,  -4,   4,   8,  -8,   4,  -4,  -6,  -6,   6,   6,   6,   6,  -6,  -6,  -4,   4,  -2,   2,  -4,   4,  -2,   2,  -3,  -3,   3,   3,  -3,  -3,   3,   3,  -4,  -4,  -2,  -2,   4,   4,   2,   2,  -2,  -2,  -1,  -1,  -2,  -2,  -1,  -1.],
	 [  4,  -0,  -4,  -0,  -4,  -0,   4,  -0,   2,  -0,  -2,  -0,   2,  -0,  -2,  -0,   2,  -0,   2,  -0,  -2,  -0,  -2,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,   1,  -0,   1,  -0,   1,  -0,   1,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0,  -0.],
	 [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   4,   0,  -4,   0,  -4,   0,   4,   0,   0,   0,   0,   0,   0,   0,   0,   0,   2,   0,  -2,   0,   2,   0,  -2,   0,   2,   0,   2,   0,  -2,   0,  -2,   0,   1,   0,   1,   0,   1,   0,   1,   0.],
	 [-12,  12,  12, -12,  12, -12, -12,  12,  -6,   6,   6,  -6,  -6,   6,   6,  -6,  -6,   6,  -6,   6,   6,  -6,   6,  -6,  -8,  -4,   8,   4,   8,   4,  -8,  -4,  -3,   3,  -3,   3,  -3,   3,  -3,   3,  -4,  -2,   4,   2,  -4,  -2,   4,   2,  -4,  -2,  -4,  -2,   4,   2,   4,   2,  -2,  -1,  -2,  -1,  -2,  -1,  -2,  -1.],
	 [  8,  -8,  -8,   8,  -8,   8,   8,  -8,   4,  -4,  -4,   4,   4,  -4,  -4,   4,   4,  -4,   4,  -4,  -4,   4,  -4,   4,   4,   4,  -4,  -4,  -4,  -4,   4,   4,   2,  -2,   2,  -2,   2,  -2,   2,  -2,   2,   2,  -2,  -2,   2,   2,  -2,  -2,   2,   2,   2,   2,  -2,  -2,  -2,  -2,   1,   1,   1,   1,   1,   1,   1,   1.]);
	
		F = []
		
		// f
		F.push(grid[1+0][1+0][1+0]);
		F.push(grid[1+0][1+0][1+1]);
		F.push(grid[1+0][1+1][1+0]);
		F.push(grid[1+0][1+1][1+1]);
		F.push(grid[1+1][1+0][1+0]);
		F.push(grid[1+1][1+0][1+1]);
		F.push(grid[1+1][1+1][1+0]);
		F.push(grid[1+1][1+1][1+1]);

		// df/dx
		F.push(fx(1+0, 1+0, 1+0));
		F.push(fx(1+0, 1+0, 1+1));
		F.push(fx(1+0, 1+1, 1+0));
		F.push(fx(1+0, 1+1, 1+1));
		F.push(fx(1+1, 1+0, 1+0));
		F.push(fx(1+1, 1+0, 1+1));
		F.push(fx(1+1, 1+1, 1+0));
		F.push(fx(1+1, 1+1, 1+1));
		
		// df/dy
		F.push(fy(1+0, 1+0, 1+0));
		F.push(fy(1+0, 1+0, 1+1));
		F.push(fy(1+0, 1+1, 1+0));
		F.push(fy(1+0, 1+1, 1+1));
		F.push(fy(1+1, 1+0, 1+0));
		F.push(fy(1+1, 1+0, 1+1));
		F.push(fy(1+1, 1+1, 1+0));
		F.push(fy(1+1, 1+1, 1+1));
		
		// df/dz
		F.push(fz(1+0, 1+0, 1+0));
		F.push(fz(1+0, 1+0, 1+1));
		F.push(fz(1+0, 1+1, 1+0));
		F.push(fz(1+0, 1+1, 1+1));
		F.push(fz(1+1, 1+0, 1+0));
		F.push(fz(1+1, 1+0, 1+1));
		F.push(fz(1+1, 1+1, 1+0));
		F.push(fz(1+1, 1+1, 1+1));
		
		// d2f/dxdy
		F.push(fxy(1+0, 1+0, 1+0));
		F.push(fxy(1+0, 1+0, 1+1));
		F.push(fxy(1+0, 1+1, 1+0));
		F.push(fxy(1+0, 1+1, 1+1));
		F.push(fxy(1+1, 1+0, 1+0));
		F.push(fxy(1+1, 1+0, 1+1));
		F.push(fxy(1+1, 1+1, 1+0));
		F.push(fxy(1+1, 1+1, 1+1));
		
		// d2f/dxdz
		F.push(fxz(1+0, 1+0, 1+0));
		F.push(fxz(1+0, 1+0, 1+1));
		F.push(fxz(1+0, 1+1, 1+0));
		F.push(fxz(1+0, 1+1, 1+1));
		F.push(fxz(1+1, 1+0, 1+0));
		F.push(fxz(1+1, 1+0, 1+1));
		F.push(fxz(1+1, 1+1, 1+0));
		F.push(fxz(1+1, 1+1, 1+1));
		
		// d2f/dydz
		F.push(fyz(1+0, 1+0, 1+0));
		F.push(fyz(1+0, 1+0, 1+1));
		F.push(fyz(1+0, 1+1, 1+0));
		F.push(fyz(1+0, 1+1, 1+1));
		F.push(fyz(1+1, 1+0, 1+0));
		F.push(fyz(1+1, 1+0, 1+1));
		F.push(fyz(1+1, 1+1, 1+0));
		F.push(fyz(1+1, 1+1, 1+1));
		
		// d3f/dxdydz
		F.push(fxyz(1+0, 1+0, 1+0));
		F.push(fxyz(1+0, 1+0, 1+1));
		F.push(fxyz(1+0, 1+1, 1+0));
		F.push(fxyz(1+0, 1+1, 1+1));
		F.push(fxyz(1+1, 1+0, 1+0));
		F.push(fxyz(1+1, 1+0, 1+1));
		F.push(fxyz(1+1, 1+1, 1+0));
		F.push(fxyz(1+1, 1+1, 1+1));
		
		coeff = [];		
		for(var ii = 0; ii < 64; ++ii)
		{
			var c = 0.0;
			for(var jj = 0; jj < 64; ++jj)
			{
				c += Minv[ii][jj] * F[jj];
			}
			coeff.push(c)
		}
	}
};
